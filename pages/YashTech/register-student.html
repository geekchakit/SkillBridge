<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>YashTech-SkillBridge | Student Registration Page</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <!-- icheck bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/icheck-bootstrap/3.0.1/icheck-bootstrap.min.css">
  <!-- Bootstrap Duallistbox -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap4-duallistbox/4.0.2/bootstrap-duallistbox.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.1.0/css/adminlte.min.css">
</head>
<body class="hold-transition register-page">
<div class="register-box" style="width: 700px; max-width: 100%;">
  <div class="card card-outline card-primary">
    <div class="card-header text-center">
      <a href="../../index2.html" class="h1"><b>YashTech</b></a>
    </div>
    <div class="card-body">
      <p class="login-box-msg">Student Registration Form</p>

      <form id="registrationForm" method="post">
        <div class="row">
          <div class="col-md-6">
            <div class="input-group mb-3">
              <input type="text" id="fullName" class="form-control" placeholder="Full Name" required>
              <div class="input-group-append">
                <div class="input-group-text">
                  <span class="fas fa-user"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="input-group mb-3">
              <select id="class" class="form-control" required>
                <option value="">Select Class</option>
                <option value="5">Class 5</option>
                <option value="6">Class 6</option>
                <option value="7">Class 7</option>
                <option value="8">Class 8</option>
                <option value="9">Class 9</option>
                <option value="10">Class 10</option>
                <option value="11">Class 11</option>
                <option value="12">Class 12</option>
              </select>
            </div>
          </div>
        </div>
      
        <div class="row">
          <div class="col-md-6">
            <div class="input-group mb-3">
              <div class="custom-file">
                <input type="file" id="photoInput" class="custom-file-input" accept="image/*" required>
                <label class="custom-file-label" for="photoInput">Choose photo</label>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="input-group mb-3">
              <select id="gender" class="form-control" required>
                <option value="">Select Gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
              </select>
            </div>
          </div>
        </div>
      
        <div class="input-group mb-3">
          <input type="text" id="schoolName" class="form-control" placeholder="School Name" required>
          <div class="input-group-append">
            <div class="input-group-text">
              <span class="fas fa-school"></span>
            </div>
          </div>
        </div>
      
        <div class="row">
          <div class="col-md-6">
            <div class="input-group mb-3">
              <input type="text" id="motherName" class="form-control" placeholder="Mother's Name" required>
              <div class="input-group-append">
                <div class="input-group-text">
                  <span class="fas fa-female"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="input-group mb-3">
              <input type="tel" id="motherContact" class="form-control" placeholder="Mother's Contact Number" required>
              <div class="input-group-append">
                <div class="input-group-text">
                  <span class="fas fa-phone"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      
        <div class="row">
          <div class="col-md-6">
            <div class="input-group mb-3">
              <input type="text" id="fatherName" class="form-control" placeholder="Father's Name" required>
              <div class="input-group-append">
                <div class="input-group-text">
                  <span class="fas fa-male"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="input-group mb-3">
              <input type="tel" id="fatherContact" class="form-control" placeholder="Father's Contact Number" required>
              <div class="input-group-append">
                <div class="input-group-text">
                  <span class="fas fa-phone"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      
        <div class="row">
          <div class="col-md-6">
            <div class="input-group mb-3">
              <select id="stream" class="form-control" required>
                <option value="">Select Stream</option>
                <option value="science">Science</option>
                <option value="commerce">Commerce</option>
                <option value="arts">Arts</option>
              </select>
            </div>
          </div>
          <div class="col-md-6">
            <div class="input-group mb-3">
              <select id="board" class="form-control" required>
                <option value="">Select Board</option>
                <option value="ICSE">ICSE</option>
                <option value="CBSE">CBSE</option>
                <option value="UP">UP Board</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Dual List Box for Subjects -->
        <div class="row">
          <div class="col-12">
            <div class="form-group">
              <select id="subjectsDualList" class="duallistbox" multiple="multiple">
                <option value="Mathematics">Mathematics</option>
                <option value="Science">Science</option>
                <option value="English">English</option>
                <option value="History">History</option>
                <option value="Geography">Geography</option>
                <option value="Physics">Physics</option>
                <option value="Chemistry">Chemistry</option>
                <option value="Biology">Biology</option>
                <option value="Computer Science">Computer Science</option>
                <option value="Economics">Economics</option>
                <option value="Accountancy">Accountancy</option>
                <option value="Business Studies">Business Studies</option>
              </select>
            </div>
          </div>
        </div>
      
        <div class="row">
          <div class="col-8">
            <div class="icheck-primary">
              <input type="checkbox" id="agreeTerms" name="terms" value="agree" required>
              <label for="agreeTerms">
                I agree to the <a href="#">terms</a>
              </label>
            </div>
          </div>
          <div class="col-4">
            <button type="button" onclick="submitForm()" class="btn btn-primary btn-block">Register</button>
          </div>
        </div>
      </form>
      

      <a href="login.html" class="text-center">I already have a membership</a>
    </div>
  </div>
</div>

<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>
<!-- Bootstrap Duallistbox -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap4-duallistbox/4.0.2/jquery.bootstrap-duallistbox.min.js"></script>
<!-- AdminLTE App -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.1.0/js/adminlte.min.js"></script>

<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<script>
  $(function () {
    $('.duallistbox').bootstrapDualListbox()
  })

  async function submitForm() {
  const formData = new FormData();

  // Gather values from input fields by their IDs
  formData.append("fullName", document.getElementById("fullName").value);
  formData.append("class", document.getElementById("class").value);
  formData.append("schoolName", document.getElementById("schoolName").value);
  formData.append("motherName", document.getElementById("motherName").value);
  formData.append("motherContact", document.getElementById("motherContact").value);
  formData.append("fatherName", document.getElementById("fatherName").value);
  formData.append("fatherContact", document.getElementById("fatherContact").value);
  formData.append("gender", document.getElementById("gender").value);
  formData.append("stream", document.getElementById("stream").value);
  formData.append("board", document.getElementById("board").value);

  // Add photo file
  const photoInput = document.getElementById("photoInput");
  if (photoInput.files.length > 0) {
    formData.append("photo", photoInput.files[0]);
  }

  // Gather selected subjects
  const selectedSubjects = Array.from(document.getElementById("subjectsDualList").selectedOptions)
    .map(option => option.value);
  formData.append("subjects", JSON.stringify(selectedSubjects)); // Convert array to JSON string

// Perform fetch and wait for response
const response = await fetch('http://localhost:5000/api/students/register', {
      method: 'POST',
      body: formData,
    });

    // Check if status is 201, which means created/success
    if (response.status === 201) {
      const data = await response.json(); // Parse response JSON if needed
      // console.log('Form submitted successfully:', data);
      swal("Success!", "Student registered successfully!", "success");
      $('#registrationForm')[0].reset(); // Reset form fields
    } else {
      // Handle cases where status is not 201
      console.error(`Unexpected response status: ${response.status}`);
      swal("Error!", "An error occurred while registering student!", "error");  
    }
}
</script>
</body>
</html>